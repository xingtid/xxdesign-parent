<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="utf-8" />
		<title>发布</title>
		<link rel="stylesheet" type="text/css" href="/simditor/css/simditor.css" />
		<link rel="stylesheet" href="/css/font-awesome.min.css"/>
		<link rel="stylesheet" href="/css/message.css"/>
		<link rel="stylesheet" href="/css/isC.css"/>
		<script src="/js/jquery-3.3.1.min.js"></script>
		<script type="text/javascript" src="/simditor/js/jquery.min.js"></script>
		<script type="text/javascript" src="/simditor/js/module.js"></script>
		<script type="text/javascript" src="/simditor/js/hotkeys.js"></script>
		<script type="text/javascript" src="/simditor/js/uploader.js"></script>
		<script type="text/javascript" src="/simditor/js/simditor.js"></script>
		<script type="text/javascript" src="/simditor/js/simditor-dropzone.js"></script>
<style type="text/css">
	.content {
		padding-left: 20px;
		width: 900px;
		min-height: 480px;
		float: inherit;
		background: #fff;
	}
</style>
	</head>
	<body>
		<div id="hint">
			<p>发布成功</p>
		</div>
		<div th:replace="userHead::head"></div>
		<div class="wrapper">
			<div class="content">
				<div class="hd">
					<strong>发布文章</strong>
				</div>
				<div class="userinfo">
					<form action="" method="post" id="myInfo">
						<dl class="clearfix">
							<dt>文章标题：</dt>
							<dd>
								<input type="text" name="title" autofocus="autofocus" placeholder="最大25个字"/>
							</dd>

						</dl>
						<div id="contextText">
							<textarea id="editor" placeholder=""></textarea>
						</div>

						<input type="hidden" id="content" name="content" value=''>
						<div class="btn-sub" style="margin-top: 30px;">
							<button type="button" onclick="insert()" style="margin-left: 42%;margin-top: 10px;">发布</button>
						</div>
				</div>
			</div>

		</div>
		</div>
		<span style="font-size:14px"><p id="back-to-top"><a href="#top"><span></span>返回顶部</a></p></span>
		<script>
			Simditor.locale = 'zh-CN';

			var editor = new Simditor({
				textarea: $('#editor'),
				//optional options
				pasteImage: true,
				upload: {
					url: '/uploadImg', //文件上传的接口地址
					params: null, //键值对,指定文件上传接口的额外参数,上传的时候随文件一起提交
					fileKey: 'file', //服务器端获取文件数据的参数名
					connectionCount: 3,
					leaveConfirm: '正在上传文件'
				}
			});
		</script>
		<script type="text/javascript">
			function hint() {
				let hit = document.getElementById("hint");
				hit.style.display = "block";
				setTimeout("closea()", 1500)
			}

			function closea() {
				let hit = document.getElementById("hint");
				hit.style.display = "none"
			}

			$('.all>li').hover(function(e) {
				$(this).children('ul').stop().slideToggle()
			});

			function insert() {
				var content = $(".simditor-body").html();
				$("#content").val(content);
				let hit = document.getElementById("hint");
				$.post("/insertContent", $("#myInfo").serialize(), function(data) {
					if (data.status == 200) {
						hint();
                        setTimeout(function (){
                            location.href = "https://www.fgyz.xyz/getContent?cId="+data.msg;
                        }, 1000);

					} else {
						hit.innerHTML = data.msg;
						hint()
					}
				});
			}
		</script>
		<script>
			$(function(){
				//当滚动条的位置处于距顶部100像素以下时，跳转链接出现，否则消失
				$(function () {
					$(window).scroll(function(){
						if ($(window).scrollTop()>100){
							$("#back-to-top").fadeIn(1500);
						}
						else
						{
							$("#back-to-top").fadeOut(1500);
						}
					});

					//当点击跳转链接后，回到页面顶部位置
					$("#back-to-top").click(function(){
						//$('body,html').animate({scrollTop:0},1000);
						if ($('html').scrollTop()) {
							$('html').animate({ scrollTop: 0 }, 1000);
							return false;
						}
						$('body').animate({ scrollTop: 0 }, 1000);
						return false;
					});
				});
			});
		</script>
	</body>
</html>
